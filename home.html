<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="color-scheme" content="dark" />
<title>Home</title>

<style>
/* =========================
   DESIGN TOKENS
   ========================= */
:root{
  /* Palette */
  --ink:#eef3ff; --ink-dim:#cfd3e1; --muted:rgba(238,243,255,.78);
  --bg:#000; --stroke:rgba(255,255,255,.18);
  --blue:#0A84FF; --green:#32d74b; --gold:#ffd700; --silver:#c0c7d1; --red:#ff453a;

  /* Layout */
  --gap:12px; --r:14px; --maxw:1240px;
  --nav-h:68px;
}
/* Reset-ish */
*{box-sizing:border-box}
html,body{height:100%}

/* ===== Header Tabs Auto-Scale & Avatar Styling ===== */
.nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  overflow: hidden;                /* stop horizontal scroll */
}

.nav .tab {
  flex: 1 1 auto;                  /* scale to fit */
  min-width: 0;                    /* shrink as needed */
  text-align: center;
  white-space: nowrap;
  font-size: clamp(13px, 3vw, 16px); /* adapt to screen */
  padding: 10px 12px;              /* tighter padding */
  border-radius: 10px;             /* same rounded corners */
}

/* Avatar tab styled same size as others */
.nav .avatar-tab {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-width: 0;
  padding: 10px 12px;
  font-size: clamp(13px, 3vw, 16px);
  border-radius: 10px;             /* left side square, right side rounded separately */
  background: var(--gold);         /* subscriber gold background */
  color: #000;
  font-weight: 800;
}

/* Avatar initials bubble on right */
.nav .avatar-initials {
  flex: 0 0 auto;
  width: 32px;
  height: 32px;
  margin-left: 8px;
  border-radius: 50%;              /* circle on right side */
  display: grid;
  place-items: center;
  font-weight: 900;
  background: rgba(0,0,0,.3);
  color: #fff;
}

body{
  margin:0; background:var(--bg); color:var(--ink);
  font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif;
  -webkit-user-select:none; user-select:none; -webkit-touch-callout:none;
}
a{color:inherit; text-decoration:none}

/* Full-bleed, fixed BG */
.bg{position:fixed; inset:0; z-index:-1; background:#000 url("./assets/home-bg.jpg") center/cover no-repeat}

/* =========================
   HEADER
   ========================= */
.nav{
  position:sticky; top:0; left:0; right:0; height:var(--nav-h);
  display:flex; align-items:center; gap:10px; padding:8px 12px; z-index:30;
  background:linear-gradient(180deg, rgba(0,0,0,.85), rgba(0,0,0,.35) 60%, transparent);
  -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
}
.nav-left{display:flex; gap:10px; align-items:center; flex:0 1 auto}
.nav-right{margin-left:auto; display:flex; align-items:center}

/* Tab buttons + Avatar tab share the same base */
.btn-tab{
  display:inline-flex; align-items:center; justify-content:center;
  min-width:116px; height:44px; padding:0 14px;
  border-radius:12px; border:1px solid var(--stroke);
  background:rgba(0,0,0,.55); color:var(--ink); font-weight:900; cursor:pointer;
  transition:transform .06s ease, filter .15s ease;
}
.btn-tab:active{transform:translateY(1px)}
.btn-tab.is-active{background:var(--blue); border-color:transparent; color:#fff}

/* Avatar control: left block (points) + round right (initials) */
.avatarTab{
  position:relative; display:inline-flex; align-items:center; gap:10px; padding-right:56px;
}
.avatarTab .points{
  font-weight:900;
}
.avatarTab .dot{
  position:absolute; right:0; top:0; bottom:0; width:44px;
  border-left:1px solid var(--stroke);
  border-top-right-radius:22px; border-bottom-right-radius:22px;
  display:grid; place-items:center; font-weight:900;
}
.avatarTab.silver{ background:var(--silver); color:#0f1116 }
.avatarTab.silver .dot{ background:linear-gradient(135deg,#d9dee6,#b7bec9) }
.avatarTab.gold{ background:var(--gold); color:#0f1116; border-color:transparent }
.avatarTab.gold .dot{ background:linear-gradient(135deg,#ffe88a,#f6c400) }

/* =========================
   WRAP
   ========================= */
.wrap{max-width:var(--maxw); margin:0 auto; padding:10px 14px 80px}

/* =========================
   HERO CARDS
   ========================= */
.hero{
  position:relative; overflow:hidden; background:#000;
  border:1px solid var(--stroke); border-radius:16px;
  padding:16px; margin:12px 0;
}
.hero .title{ margin:0 0 6px; font-weight:900; font-size:20px; display:flex; align-items:center; gap:8px }
.hero .meta{ margin:0 0 6px; color:var(--ink-dim) }
.hero .desc{ margin:8px 0 56px; color:var(--muted) } /* space for CTAs */

.cta-left{ position:absolute; left:16px; bottom:14px; display:flex; gap:10px }

/* Buttons */
.btn{ padding:12px 16px; border-radius:12px; border:0; font-weight:900; cursor:pointer }
.btn.blue{background:var(--blue); color:#fff}
.btn.green{background:var(--green); color:#000}
.btn.gold{background:var(--gold); color:#0f1116}
.btn.grey{background:#3a3a3a; color:#fff}
.btn[disabled]{opacity:.55; cursor:not-allowed}

/* Silver padlock icon */
.padlock{ width:22px; height:22px; display:inline-block; vertical-align:-3px }
.padlock svg{ width:100%; height:100% }
.padlock .shackle{ fill:none; stroke:var(--silver); stroke-width:2.4 }
.padlock .body{ fill:var(--silver) }
.padlock .keyhole{ fill:#0f1116 }

/* Price + Points bubble (disappear when purchased) */
.price, .pts{
  position:absolute; right:12px; border-radius:999px; font-weight:900; padding:6px 10px;
  background:rgba(0,0,0,.6); border:1px solid var(--stroke)
}
.price{ bottom:12px; color:#fff }
.pts{ top:12px; color:#0f1116; background:var(--gold); border-color:transparent; box-shadow:0 6px 18px rgba(255,215,0,.22) }
.pts[hidden], .price[hidden]{ display:none }

/* Completion ring + tick */
.hero.complete{ box-shadow:0 0 0 3px var(--green) inset }
.hero.complete .title::after{ content:" ✓"; color:var(--green); font-weight:900 }

/* Layouts */
.weekly-grid{ display:grid; gap:var(--gap) }
.grid-3{ grid-template-columns:repeat(3,minmax(0,1fr)) }

/* Portrait: stack weekly + taller course/weekly heroes for readability */
@media (orientation:portrait){
  .weekly-grid{ grid-template-columns:1fr }
  .hero.tall{ min-height: 360px } /* +20% for iPhone readability */
  #dailyHero{ min-height: 260px }  /* daily in portrait */
}

/* Landscape: daily spans full width; weekly/courses 3-up and higher */
@media (orientation:landscape){
  .weekly-grid{ grid-template-columns:repeat(3,minmax(0,1fr)) }
  .hero.tall{ min-height: 300px }
  #dailyHero{ min-height: 220px }
}

/* =========================
   BOTTOM SHEET (Avatar menu)
   ========================= */
.sheet{
  position:fixed; inset:0; display:none; z-index:60;
  background:rgba(0,0,0,.5); -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
}
.sheet.open{ display:block }
.sheet .panel{
  position:absolute; left:0; right:0; bottom:0; border-top-left-radius:18px; border-top-right-radius:18px;
  background:#0f1116; border-top:1px solid var(--stroke); padding:14px; max-height:80vh; overflow:auto;
}
.sheet .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px 12px; border-radius:12px; border:1px solid var(--stroke); background:#0a0f14; margin-bottom:10px }
.sheet .row a{ font-weight:900 }
.sheet h3{ margin:6px 2px 10px; font-size:16px }

/* Utilities */
.section-title{ margin:18px 2px 8px; font-size:18px; font-weight:900 }
.sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0 }
.hide{ display:none !important }
</style>
</head>
<body>

<div class="bg" aria-hidden="true"></div>

<header class="nav">
  <div class="nav-left" role="tablist" aria-label="Primary">
    <button class="btn-tab is-active" data-tab="challenges" aria-selected="true">Challenges</button>
    <button class="btn-tab" data-tab="courses" aria-selected="false">Courses</button>
    <button class="btn-tab" data-tab="live" aria-selected="false">Live</button>
  </div>

  <div class="nav-right">
    <!-- Avatar tab (points + initials) -->
    <button id="avatarTab" class="btn-tab avatarTab silver" aria-haspopup="dialog" aria-expanded="false">
      <span class="points" id="pointsBadge">0</span>
      <span class="dot" id="avatarInitials">JG</span>
    </button>
  </div>
</header>

<main class="wrap">
  <!-- TABS -->
  <section id="panel-challenges" data-panel="challenges">
    <article class="hero" id="dailyHero" aria-labelledby="dailyTitle">
      <h2 class="title" id="dailyTitle">Today’s Daily Challenge</h2>
      <p class="meta" id="dailyDate">—</p>
      <p class="desc" id="dailyDesc">Warm up: 15–20 minutes of quick charcoal gestures. Fill one page with 10–15 poses focusing on big shapes and clear value separation.</p>
      <div class="cta-left">
        <button class="btn blue" id="btnDaily">Complete</button>
      </div>
    </article>

    <h3 class="section-title">Weekly Challenges (Subscribers)</h3>
    <div class="weekly-grid" id="weeklyGrid"></div>
  </section>

  <section id="panel-courses" class="hide" data-panel="courses">
    <h2 class="section-title">Foundations (Subscribers)</h2>
    <div class="weekly-grid">
      <!-- Foundations -->
      <article class="hero tall course" data-id="found-setup" data-kind="foundation">
        <h3 class="title">
          <svg class="padlock" aria-hidden="true" viewBox="0 0 24 24">
            <path class="shackle" d="M7 11V8.5a5 5 0 0 1 10 0V11"/>
            <rect class="body" x="3" y="11" width="18" height="10" rx="2"/>
            <circle class="keyhole" cx="12" cy="16" r="1.3"/>
            <rect class="keyhole" x="11.2" y="14.7" width="1.6" height="2.8" rx="0.6"/>
          </svg>
          Materials &amp; Setup
        </h3>
        <p class="meta">Prepare your space: paper, charcoal, inks, brushes, safe layout.</p>
        <p class="desc">Step-by-step setup to start drawing/painting with confidence.</p>
        <div class="cta-left">
          <button class="btn blue start-found" disabled>Start Course</button>
        </div>
      </article>

      <article class="hero tall course" data-id="found-drawing" data-kind="foundation">
        <h3 class="title">
          <svg class="padlock" aria-hidden="true" viewBox="0 0 24 24">
            <path class="shackle" d="M7 11V8.5a5 5 0 0 1 10 0V11"/>
            <rect class="body" x="3" y="11" width="18" height="10" rx="2"/>
            <circle class="keyhole" cx="12" cy="16" r="1.3"/>
            <rect class="keyhole" x="11.2" y="14.7" width="1.6" height="2.8" rx="0.6"/>
          </svg>
          Drawing
        </h3>
        <p class="meta">Line, tone, proportion, gesture, observation.</p>
        <p class="desc">Foundational drills to build accuracy and flow.</p>
        <div class="cta-left">
          <button class="btn blue start-found" disabled>Start Course</button>
        </div>
      </article>

      <article class="hero tall course" data-id="found-painting" data-kind="foundation">
        <h3 class="title">
          <svg class="padlock" aria-hidden="true" viewBox="0 0 24 24">
            <path class="shackle" d="M7 11V8.5a5 5 0 0 1 10 0V11"/>
            <rect class="body" x="3" y="11" width="18" height="10" rx="2"/>
            <circle class="keyhole" cx="12" cy="16" r="1.3"/>
            <rect class="keyhole" x="11.2" y="14.7" width="1.6" height="2.8" rx="0.6"/>
          </svg>
          Painting
        </h3>
        <p class="meta">Surface prep, colour mixing, value structure, brushwork.</p>
        <p class="desc">Learn stable processes that free you to be expressive.</p>
        <div class="cta-left">
          <button class="btn blue start-found" disabled>Start Course</button>
        </div>
      </article>
    </div>

    <!-- Paid courses etc stay the same (no padlocks needed there) -->
    … (rest of your section unchanged) …
  </section>
</main>

<!-- ============ AVATAR BOTTOM SHEET ============ -->
<div class="sheet" id="avatarSheet" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="panel" role="document">
    <h3>Account</h3>
    <div class="row">
      <strong>Subscription</strong>
      <button class="btn grey" id="subToggle" aria-pressed="false">Off</button>
    </div>
    <div class="row"><a href="#" id="openCalendar">My Calendar</a><span>›</span></div>
    <div class="row"><a href="profile.html#achievements">Achievements</a><span>›</span></div>
    <h3>Shortcuts</h3>
    <div class="row"><a href="profile.html#slot1">Placeholder 1</a><span>›</span></div>
    <div class="row"><a href="profile.html#slot2">Placeholder 2</a><span>›</span></div>
    <div class="row"><a href="profile.html#slot3">Placeholder 3</a><span>›</span></div>
    <h3>Avatar</h3>
    <div class="row"><a href="#" id="uploadAvatar">Upload Avatar (soon)</a><span>›</span></div>
    <div class="row"><button class="btn grey" id="closeSheet">Close</button></div>
  </div>
</div>

<!-- Optional inline pricing fallback (replace later / or inject window.PRICE_LIST) -->
<script id="pricingData" type="application/json">
{
  "1d-gesture":{"price":"$39","points":300},
  "1d-ink":{"price":"$39","points":300},
  "1d-charcoal":{"price":"$39","points":300},
  "3d-portrait":{"price":"$79","points":500},
  "3d-urban":{"price":"$79","points":500},
  "3d-experimental":{"price":"$79","points":500},
  "live-1":{"price":"$29","points":1800},
  "live-2":{"price":"$29","points":1800},
  "live-3":{"price":"$29","points":1800}
}
</script>

<script>
(()=>{'use strict';
/* ---------- Helpers ---------- */
const $=s=>document.querySelector(s);
const $$=s=>Array.from(document.querySelectorAll(s));
const pad=n=>String(n).padStart(2,'0');
const toISO=d=>d.toISOString().slice(0,10);
const k={
  sub:'ao_sub', points:'ao_points', purchased:'ao_purchased',
  weeklyDone:'ao_weekly_done', dailyDone:'ao_daily_done', avatar:'ao_avatar'
};
const store={ get:(k,f)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},
              set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)) };
const compactK = n => (n>=1000? (Math.floor(n/1000)+'k'): String(n)); // no decimals

/* ---------- State ---------- */
let isSub=!!store.get(k.sub,false);
let points=+store.get(k.points,0);
let purchased=store.get(k.purchased,[]);
let weeklyDone=store.get(k.weeklyDone,[]); // ids
let dailyDone=store.get(k.dailyDone,[]);   // ["YYYY-MM-DD"]

/* ---------- Header Tabs ---------- */
const tabBtns=$$('.btn-tab[data-tab]');
const panels=$$('[data-panel]');
tabBtns.forEach(b=>{
  b.addEventListener('click', ()=>{
    tabBtns.forEach(x=>{x.classList.toggle('is-active',x===b); x.setAttribute('aria-selected', x===b?'true':'false');});
    panels.forEach(p=>p.classList.toggle('hide', p.dataset.panel!==b.dataset.tab));
    window.scrollTo({top:0,behavior:'smooth'});
  });
});

/* ---------- Avatar control ---------- */
const avatarBtn = $('#avatarTab');
const avatarSheet = $('#avatarSheet');
const subToggle = $('#subToggle');
const pointsBadge = $('#pointsBadge');
const avatarInitials = $('#avatarInitials');

function paintAvatar(){
  pointsBadge.textContent = compactK(points);
  avatarBtn.classList.toggle('gold', isSub);
  avatarBtn.classList.toggle('silver', !isSub);
  subToggle.textContent = isSub?'On':'Off';
  subToggle.className = 'btn ' + (isSub?'green':'grey');
  subToggle.setAttribute('aria-pressed', isSub?'true':'false');
}
paintAvatar();

avatarBtn.addEventListener('click', ()=>{
  avatarSheet.classList.add('open');
  avatarSheet.setAttribute('aria-hidden','false');
  avatarBtn.setAttribute('aria-expanded','true');
});
$('#closeSheet').addEventListener('click', closeSheet);
avatarSheet.addEventListener('click', (e)=>{ if(e.target===avatarSheet) closeSheet(); });
function closeSheet(){
  avatarSheet.classList.remove('open');
  avatarSheet.setAttribute('aria-hidden','true');
  avatarBtn.setAttribute('aria-expanded','false');
}

subToggle.addEventListener('click', ()=>{
  isSub = !isSub; store.set(k.sub,isSub); paintAvatar(); paintGating(); paintWeeklies(); 
});

$('#uploadAvatar').addEventListener('click', (e)=>{ e.preventDefault(); alert('Avatar upload coming soon.'); });

/* ---------- Daily ---------- */
const dayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const today=new Date(), isoToday=toISO(today);
$('#dailyDate').textContent = `${dayNames[today.getDay()]} ${pad(today.getDate())}/${pad(today.getMonth()+1)}`;

function paintDaily(){
  const done = dailyDone.includes(isoToday);
  $('#btnDaily').textContent = done?'Undo':'Complete';
  $('#btnDaily').className = 'btn ' + (done?'grey':'blue');
  $('#dailyHero').classList.toggle('complete', done);
}
paintDaily();

$('#btnDaily').addEventListener('click', ()=>{
  const idx=dailyDone.indexOf(isoToday);
  if(idx===-1){ dailyDone.push(isoToday); points+=1; }
  else{ dailyDone.splice(idx,1); points=Math.max(0,points-1); }
  store.set(k.dailyDone,dailyDone); store.set(k.points,points); paintDaily(); paintAvatar();
});

/* ---------- Weekly (3 only) ---------- */
const WEEKLY = [
  {id:'W1', title:'Ink Portrait', desc:'Brush + splash accents.'},
  {id:'W2', title:'Value Composition', desc:'Design with 3 clear values.'},
  {id:'W3', title:'Edges & Atmosphere', desc:'Depth via soft transitions.'}
];
function weeklyOrder(){
  // done items at end (portrait: bottom; landscape grid naturally pushes rightmost)
  const doneSet=new Set(weeklyDone);
  return WEEKLY.slice().sort((a,b)=>{
    const A=doneSet.has(a.id), B=doneSet.has(b.id);
    return (A===B)?0 : (A?1:-1);
  });
}
function padlockSVG(){
  return `<span class="padlock" aria-hidden="true">
    <svg viewBox="0 0 24 24"><path class="shackle" d="M7 11V8.5a5 5 0 0 1 10 0V11"/></svg>
    <svg viewBox="0 0 24 24" style="position:absolute;inset:0;opacity:0"><rect class="body" x="3" y="11" width="18" height="10" rx="2"/><circle class="keyhole" cx="12" cy="16" r="1.3"/><rect class="keyhole" x="11.2" y="14.7" width="1.6" height="2.8" rx=".6"/></svg>
  </span>`;
}
function paintWeeklies(){
  const grid = $('#weeklyGrid'); grid.innerHTML='';
  weeklyOrder().forEach(w=>{
    const done = weeklyDone.includes(w.id);
    const el = document.createElement('article');
    el.className = 'hero tall' + (done?' complete':'');
    el.dataset.week = w.id;
    el.innerHTML = `
      <h4 class="title">${isSub?'':padlockSVG()} ${w.title}</h4>
      <p class="meta">Sun ${pad(today.getDate())}/${pad(today.getMonth()+1)}</p>
      <p class="desc">${w.desc}</p>
      <div class="cta-left">
        <a class="btn ${isSub?'blue':''}" ${isSub?'':'aria-disabled="true"'} ${isSub?'href="weekly-${w.id}.html"':''}>Start Challenge</a>
      </div>`;
    grid.appendChild(el);
  });
}
paintWeeklies();

/* public API for weekly pages to mark completion */
window.AO_markWeeklyComplete = function(weekId, title){
  if(!weeklyDone.includes(weekId)){
    weeklyDone.push(weekId);
    store.set(k.weeklyDone, weeklyDone);
    points += 10; store.set(k.points,points); paintAvatar(); paintWeeklies();
  }
};

/* ---------- Courses: pricing + buy/redeem flow ---------- */
let pricing = {};
function readPricing(){
  if(window.PRICE_LIST) pricing = window.PRICE_LIST;
  else{
    const j=$('#pricingData'); if(j){ try{ pricing=JSON.parse(j.textContent||'{}'); }catch{} }
  }
  // apply
  $$('.course, .live').forEach(card=>{
    const id = card.dataset.id; const p = pricing[id]||{};
    const priceEl = card.querySelector('.price'); const ptsEl = card.querySelector('.pts');
    if(p.price && priceEl){ priceEl.dataset.price = p.price; priceEl.firstElementChild.textContent=p.price; }
    if(p.points!=null && ptsEl){ ptsEl.dataset.pts = p.points; ptsEl.firstElementChild.textContent = p.points; }
  });
}
readPricing();

function paintGating(){
  // Foundational courses gated by sub
  $$('.course[data-kind="foundation"]').forEach(card=>{
    const btn=card.querySelector('.start-found');
    if(isSub){ btn.removeAttribute('disabled'); card.querySelector('.padlock')?.classList.add('hide'); }
    else{ btn.setAttribute('disabled',''); card.querySelector('.padlock')?.classList.remove('hide'); }
  });
  // Weekly gating is handled in paintWeeklies (padlock on title)
}
paintGating();

function markPurchased(card){
  // hide price + points, turn button into Enter
  card.querySelector('.price')?.setAttribute('hidden','');
  card.querySelector('.pts')?.setAttribute('hidden','');
  const b = card.querySelector('.buy');
  if(b){ b.textContent='Enter'; b.className='btn green enter'; }
}
purchased.forEach(id=>{
  const card = document.querySelector(`[data-id="${id}"]`); if(card) markPurchased(card);
});

document.addEventListener('click', e=>{
  const b=e.target.closest('.buy'); if(!b) return;
  const card = b.closest('.hero'); const id = card.dataset.id;
  const ptsEl = card.querySelector('.pts'); const need = +(ptsEl?.dataset.pts||0);

  // Simple buy sheet (green Buy or Redeem hidden inside dialog)
  const choice = confirm(ptsEl?`Buy with money (${card.querySelector('.price span').textContent})?\n\nPress “OK” for card payment.\nPress “Cancel” to try Redeem with Points.`:`Proceed to payment?`);
  if(choice){
    // simulate success
    if(!purchased.includes(id)){ purchased.push(id); store.set(k.purchased,purchased); }
    markPurchased(card);
  }else{
    // Redeem path
    if(points < need){ alert(`You have ${points} pts. Need ${need-points} more.`); return; }
    points -= need; store.set(k.points,points); paintAvatar();
    if(!purchased.includes(id)){ purchased.push(id); store.set(k.purchased,purchased); }
    markPurchased(card);
  }
});

/* ---------- Calendar stub from avatar sheet ---------- */
$('#openCalendar').addEventListener('click', (e)=>{ e.preventDefault(); alert('Calendar will appear here in a future build.'); });

/* ---------- Init points display ---------- */
paintAvatar();

})();
</script>
</body>
</html>